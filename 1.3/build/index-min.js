/*! switchable - v1.3 - 2013-06-05 11:11:49 AM
* Copyright (c) 2013 yiminghe; Licensed  */
KISSY.add("gallery/switchable/1.3/base",function(e,t,n,a){function i(n,i){var r=this;r._triggerInternalCls=e.guid(I),r._panelInternalCls=e.guid(T),i=i||{},"markupType"in i||(i.panelCls?i.markupType=1:i.panels&&(i.markupType=2));for(var s=r.constructor;s;)i=e.merge(s.Config,i),s=s.superclass?s.superclass.constructor:null;r.container=t.get(n),r.config=i,r.activeIndex=i.activeIndex;var c;r.activeIndex>-1||("number"==typeof i.switchTo?c=i.switchTo:r.activeIndex=0),r._init(),r._initPlugins(),r.fire(v),c!==a&&r.switchTo(c)}function r(e){if(e&&e.length){if(1==e.length)return e[0].parentNode;for(var n=e[0],a=0;!a&&n!=document.body;){n=n.parentNode,a=1;for(var i=1;e.length>i;i++)if(!t.contains(n,e[i])){a=0;break}}return n}return null}function s(e){var t={};return t.type=e.type,t.target=e.target,{originalEvent:t}}var c="display",o="block",l=e.makeArray,u="none",f=n.Target,g="forward",d="backward",h=".",v="init",p="beforeSwitch",m="switch",b="beforeRemove",y="add",x="remove",w="ks-switchable-",I=w+"trigger-internal",T=w+"panel-internal";return i.getDomEvent=s,i.addPlugin=function(e,t){t=t||i;for(var n=e.priority=e.priority||0,a=0,r=t.Plugins=t.Plugins||[];r.length>a&&!(n>r[a].priority);a++);r.splice(a,0,e)},i.Config={markupType:0,navCls:w+"nav",contentCls:w+"content",triggerCls:w+"trigger",panelCls:w+"panel",triggers:[],panels:[],hasTriggers:!0,triggerType:"mouse",delay:.1,activeIndex:-1,activeTriggerCls:"ks-active",switchTo:a,steps:1,viewSize:[]},e.augment(i,f,{_initPlugins:function(){for(var t=this,n=[],a=t.constructor;a;)a.Plugins&&n.push.apply(n,[].concat(a.Plugins).reverse()),a=a.superclass?a.superclass.constructor:null;n.reverse(),e.each(n,function(e){e.init&&e.init(t)})},_init:function(){var e=this,t=e.config;e._parseMarkup(),t.hasTriggers&&e._bindTriggers(),e._bindPanels()},_parseMarkup:function(){var e,n,a,i=this,s=i.container,c=i.config,o=[],u=[];switch(c.markupType){case 0:e=t.get(h+c.navCls,s),e&&(o=t.children(e)),n=t.get(h+c.contentCls,s),u=t.children(n);break;case 1:o=t.query(h+c.triggerCls,s),u=t.query(h+c.panelCls,s);break;case 2:o=c.triggers,u=c.panels,e=c.nav,n=c.content}a=u.length,i.length=Math.ceil(a/c.steps),i.nav=e||c.hasTriggers&&r(o),!c.hasTriggers||i.nav&&0!=o.length||(o=i._generateTriggersMarkup(i.length)),i.triggers=l(o),i.panels=l(u),i.content=n||r(u)},_generateTriggersMarkup:function(e){var n,a,i=this,r=i.config,s=i.nav||t.create("<ul>");for(s.className=r.navCls,a=0;e>a;a++)n=t.create("<li>"),a===i.activeIndex&&(n.className=r.activeTriggerCls),n.innerHTML=a+1,s.appendChild(n);return i.container.appendChild(s),i.nav=s,t.children(s)},_bindTriggers:function(){var t=this,a=t.config,i=t._triggerInternalCls,r=t.nav,s=t.triggers;e.each(s,function(e){t._initTrigger(e)}),n.delegate(r,"click","."+i,function(e){var n=e.currentTarget,a=t._getTriggerIndex(n);t._onFocusTrigger(a,e)}),"mouse"===a.triggerType&&(n.delegate(r,"mouseenter","."+i,function(e){var n=e.currentTarget,a=t._getTriggerIndex(n);t._onMouseEnterTrigger(a,e)}),n.delegate(r,"mouseleave","."+i,function(){t._onMouseLeaveTrigger()}))},_initTrigger:function(e){t.addClass(e,this._triggerInternalCls)},_bindPanels:function(){var t=this,n=t.panels;e.each(n,function(e){t._initPanel(e)})},_initPanel:function(e){t.addClass(e,this._panelInternalCls)},_onFocusTrigger:function(e,t){var n=this;n._triggerIsValid(e)&&(this._cancelSwitchTimer(),n.switchTo(e,a,s(t)))},_onMouseEnterTrigger:function(t,n){var i=this;if(i._triggerIsValid(t)){var r=s(n);i.switchTimer=e.later(function(){i.switchTo(t,a,r)},1e3*i.config.delay)}},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_triggerIsValid:function(e){return this.activeIndex!==e},_cancelSwitchTimer:function(){var e=this;e.switchTimer&&(e.switchTimer.cancel(),e.switchTimer=a)},_getTriggerIndex:function(t){var n=this;return e.indexOf(t,n.triggers)},_resetLength:function(){this.length=this._getLength()},_getLength:function(e){var t=this,n=t.config;return e===a&&(e=t.panels.length),Math.ceil(e/n.steps)},_afterAdd:function(e,t,n){var i=this;i._resetLength();var r=i._getLength(e+1)-1;1==i.config.steps&&i.activeIndex>=r&&(i.activeIndex+=1);var s=i.activeIndex;i.activeIndex=-1,i.switchTo(s),t?i.switchTo(r,a,a,n):n()},add:function(n){var a=n.callback||e.noop,i=this,r=i.nav,s=i.content,c=n.trigger,o=n.panel,l=n.active,u=i.panels.length,f=null!=n.index?n.index:u,g=i.triggers,d=i.panels,h=i.length,v=null,p=null;f=Math.max(0,Math.min(f,u));var m=d[f]||null;d.splice(f,0,o),s.insertBefore(o,m),1==i.config.steps?(p=g[f]||null,r.insertBefore(c,p),g.splice(f,0,c)):(v=i._getLength(),v!=h&&(t.append(c,r),g.push(c))),i._initPanel(o),i._initTrigger(c),i._afterAdd(f,l,a),i.fire(y,{index:f,trigger:c,panel:o})},remove:function(n){function i(){if(h&&(t.remove(h),u.splice(r,1)),d){t.remove(d);for(var e=0;g.length>e;e++)if(g[e]==d){c.triggers.splice(e,1);break}}c._resetLength(),c.fire(x,{index:r,trigger:d,panel:h})}var r,s=n.callback||e.noop,c=this,o=c.config.steps,l=c.length,u=c.panels;r="index"in n?n.index:n.panel;var f=c._getLength(u.length-1),g=c.triggers,d=null,h=null;if(u.length&&(r=e.isNumber(r)?Math.max(0,Math.min(r,u.length-1)):e.indexOf(r,u),d=1==o?g[r]:f!==l?g[l-1]:null,h=u[r],c.fire(b,{index:r,panel:h,trigger:d})!==!1)){if(0==f)return i(),s(),a;var v=c.activeIndex;if(o>1)return v==f?c.switchTo(v-1,a,a,function(){i(),s()}):(i(),c.activeIndex=-1,c.switchTo(v,a,a,function(){s()})),a;if(v==r){var p=v>0?v-1:v+1;c.switchTo(p,a,a,function(){i(),0==v&&(c.activeIndex=0),s()})}else v>r&&(v--,c.activeIndex=v),i(),s()}},switchTo:function(e,t,n,i){var r=this,s=r.config,c=r.activeIndex,o=r.triggers;return r._triggerIsValid(e)?r.fire(p,{fromIndex:c,toIndex:e})===!1?r:(r.fromIndex=c,s.hasTriggers&&r._switchTrigger(o[c]||null,o[e]),t===a&&(t=e>c?g:d),r.activeIndex=e,r._switchView(t,n,function(){i&&i.call(r)}),r):r},_switchTrigger:function(e,n){var a=this.config.activeTriggerCls;e&&t.removeClass(e,a),t.addClass(n,a)},_getFromToPanels:function(){var e,t,n=this,a=n.fromIndex,i=n.config.steps,r=n.panels,s=n.activeIndex;return e=a>-1?r.slice(a*i,(a+1)*i):null,t=r.slice(s*i,(s+1)*i),{fromPanels:e,toPanels:t}},_switchView:function(e,n,a){var i=this,r=i._getFromToPanels(),s=r.fromPanels,l=r.toPanels;s&&t.css(s,c,u),t.css(l,c,o),setTimeout(function(){i._fireOnSwitch(n)},0),a&&a.call(this)},_fireOnSwitch:function(t){var n=this;n.fire(m,e.merge(t,{fromIndex:n.fromIndex,currentIndex:this.activeIndex}))},prev:function(e){var t=this;t.switchTo((t.activeIndex-1+t.length)%t.length,d,e)},next:function(e){var t=this;t.switchTo((t.activeIndex+1)%t.length,g,e)},destroy:function(a){for(var i=this,r=i.constructor;r;)e.each(r.Plugins,function(e){e.destroy&&e.destroy(i)}),r=r.superclass?r.superclass.constructor:null;a?(n.remove(i.container),i.content&&n.remove(i.content),i.nav&&n.remove(i.nav)):t.remove(i.container),i.nav=null,i.content=null,i.container=null,i.triggers=[],i.panels=[],i.detach()}}),i},{requires:["dom","event"]}),KISSY.add("gallery/switchable/1.3/accordion/base",function(e,t,n){function a(e,t){var n=this;return n instanceof a?(a.superclass.constructor.apply(n,arguments),void 0):new a(e,t)}return e.extend(a,n,{_switchTrigger:function(e,n){var i=this,r=i.config;r.multiple?t.toggleClass(n,r.activeTriggerCls):a.superclass._switchTrigger.apply(i,arguments)},_triggerIsValid:function(e){return this.config.multiple||a.superclass._triggerIsValid.call(this,e)},_switchView:function(e,n,i){var r=this,s=r.config,c=r._getFromToPanels().toPanels;s.multiple?(t.toggle(c),this._fireOnSwitch(n),i&&i.call(this)):a.superclass._switchView.apply(r,arguments)}}),a.Config={markupType:1,triggerType:"click",multiple:!1},a},{requires:["dom","../base"]}),KISSY.add(function(e,t,n,a){function i(e,t){var n=this;return n instanceof i?(i.superclass.constructor.apply(n,arguments),void 0):new i(e,t)}var r="ks-switchable-",s=".",c="added",o="removed",l="prevBtn",u="nextBtn",f={originalEvent:{target:1}};return i.Config={circular:!0,prevBtnCls:r+"prev-btn",nextBtnCls:r+"next-btn",disableBtnCls:r+"disable-btn"},e.extend(i,a,{_init:function(){function a(e){t.removeClass([r[l],r[u]],d),0==e&&t.addClass(r[l],d),e==r.length-1&&t.addClass(r[u],d)}var r=this;i.superclass._init.call(r);var g=r.config,d=g.disableBtnCls;e.each(["prev","next"],function(e){var a=r[e+"Btn"]=t.get(s+g[e+"BtnCls"],r.container);n.on(a,"mousedown",function(t){t.preventDefault();var n=r.activeIndex;"prev"!=e||0==n&&!g.circular||r[e](f),"next"!=e||n==r.length-1&&!g.circular||r[e](f)})}),g.circular||(r.on(c+" "+o,function(){a(r.activeIndex)}),r.on("switch",function(e){a(e.currentIndex)})),n.delegate(r.content,"click",s+r._panelInternalCls,function(e){var t=e.currentTarget;r.fire("itemSelected",{item:t})})},destroy:function(e){var t=this;e&&(t.nextBtn&&n.remove(t.nextBtn),t.prevBtn&&n.remove(t.prevBtn)),i.superclass.destroy.apply(t,arguments)}}),i},{requires:["dom","event","../base"]}),KISSY.add("gallery/switchable/1.3/slide/base",function(e,t){function n(e,t){var a=this;return a instanceof n?(n.superclass.constructor.apply(a,arguments),void 0):new n(e,t)}return n.Config={autoplay:!0,circular:!0},e.extend(n,t),n},{requires:["../base"]}),KISSY.add("gallery/switchable/1.3/tabs/base",function(e,t){function n(e,t){var a=this;return a instanceof n?(n.superclass.constructor.call(a,e,t),0):new n(e,t)}return e.extend(n,t),n.Config={},n},{requires:["../base"]}),KISSY.add("gallery/switchable/1.3/lazyload",function(e,t,n){function a(e,t){t=t||l;var n=e.getAttribute(t);n&&e.src!=n&&(e.src=n,e.removeAttribute(t))}function i(n,i,s){var c;"img-src"===i&&(i="img"),e.isArray(n)||(n=[t.get(n)]),e.each(n,function(n){switch(i){case"img":c="IMG"===n.nodeName?[n]:t.query("img",n),e.each(c,function(e){a(e,s||l+f)});break;default:t.query("textarea",n).each(function(e){t.hasClass(e,s||u+f)&&r(e,!0)})}})}function r(e,n){e.style.display="none",e.className="";var a=t.create("<div>");e.parentNode.insertBefore(a,e),t.html(a,e.value,n)}var s="beforeSwitch",c="img",o="textarea",l="data-ks-lazyload",u="ks-datalazyload",f="-custom",g={};return g[c]="lazyImgAttribute",g[o]="lazyTextareaClass",e.mix(n.Config,{lazyImgAttribute:"data-ks-lazyload-custom",lazyTextareaClass:"ks-datalazyload-custom",lazyDataType:o}),n.addPlugin({name:"lazyload",init:function(e){function n(t){var c=e._realStep||l.steps,o=t.toIndex*c,f=o+c;i(e.panels.slice(o,f),u,r),a()&&e.detach(s,n)}function a(){var n,a,i,s,l=u===c,f=l?"img":u===o?"textarea":"";if(f)for(n=t.query(f,e.container),a=0,s=n.length;s>a;a++)if(i=n[a],l?t.attr(i,r):t.hasClass(i,r))return!1;return!0}var r,l=e.config,u=l.lazyDataType;"img-src"===u?u=c:"area-data"===u&&(u=o),l.lazyDataType=u,r=l[g[u]],u&&r&&(e.on(s,n),n({toIndex:e.activeIndex}))}}),n},{requires:["dom","./base"]}),KISSY.add("gallery/switchable/1.3/effect",function(e,t,n,a,i,r){var s,c="display",o="block",l="none",u="opacity",f="z-index",g="position",d="relative",h="absolute",v="scrollx",p="scrolly",m="fade",b="left",y="top",x="float",w="px";return e.mix(i.Config,{effect:l,duration:.5,easing:"easeNone"}),i.Effects={none:function(e){var n=this,a=n._getFromToPanels(),i=a.fromPanels,r=a.toPanels;i&&t.css(i,c,l),t.css(r,c,o),e&&e()},fade:function(n){var i=this,s=i._getFromToPanels(),c=s.fromPanels,o=s.toPanels;c&&1!==c.length&&e.error("fade effect only supports steps == 1.");var l=i.config,g=c?c[0]:null,d=o[0];i.anim&&(i.anim.stop(),t.css(i.anim.fromEl,{zIndex:1,opacity:0}),t.css(i.anim.toEl,"zIndex",9)),t.css(d,u,1),g?(i.anim=new a(g,{opacity:0},l.duration,l.easing,function(){i.anim=r,t.css(d,f,9),t.css(g,f,1),n&&n()}).run(),i.anim.toEl=d,i.anim.fromEl=g):(t.css(d,f,9),n&&n())},scroll:function(e,n,i){var s=this,c=s.fromIndex,o=s.config,l=o.effect===v,u=s.viewSize[l?0:1]*s.activeIndex,f={};f[l?b:y]=-u+w,s.anim&&s.anim.stop(),i||c>-1?s.anim=new a(s.content,f,o.duration,o.easing,function(){s.anim=r,e&&e()}).run():(t.css(s.content,f),e&&e())}},s=i.Effects,s[v]=s[p]=s.scroll,i.addPlugin({priority:10,name:"effect",init:function(n){var a=n.config,i=a.effect,r=n.panels,s=n.content,u=a.steps,f=r[0],y=n.container,w=n.activeIndex;if(i!==l)switch(t.css(r,c,o),i){case v:case p:if(t.css(s,g,h),"static"==t.css(s.parentNode,g)&&t.css(s.parentNode,g,d),i===v&&(t.css(r,x,b),t.width(s,"999999px")),n.viewSize=[a.viewSize[0]||f&&t.outerWidth(f,!0)*u,a.viewSize[1]||f&&t.outerHeight(f,!0)*u],n.viewSize[0]||e.error("switchable must specify viewSize if there is no panels"),1==u&&f){var I=1,T=n.viewSize,_=f.parentNode.parentNode,k=[Math.min(t.width(y),t.width(_)),Math.min(t.height(y),t.height(_))];"scrollx"==i?I=Math.floor(k[0]/T[0]):"scrolly"==i&&(I=Math.floor(k[1]/T[1])),I>a.steps&&(n._realStep=I)}break;case m:var C,S=w*u,P=S+u-1;e.each(r,function(e,n){C=n>=S&&P>=n,t.css(e,{opacity:C?1:0,position:h,zIndex:C?9:1})})}}}),e.augment(i,{_switchView:function(t,n,a){var i=this,r=i.config,c=r.effect,o=e.isFunction(c)?c:s[c];o.call(i,function(){i._fireOnSwitch(n),a&&a.call(i)},t)}}),i},{requires:["dom","event","anim","./base"]}),KISSY.add("gallery/switchable/1.3/circular",function(e,t,n,a){function i(e){var a,i=this,r=i.fromIndex,s=i.config,c=i.length,l="scrollx"===s.scrollType,u=l?"left":"top",f=i.activeIndex,g=i.viewSize[l?0:1],d=i.panels,h={},v={},p=i._realStep,m=g*c;if(h[u]=-g*f,-1==r)return t.css(i.content,h),e&&e(),void 0;f+p>c?(v={position:"relative"},v[u]=m,a=f+p-c,t.css(d.slice(0,a),v),t.css(d.slice(a,p),o)):t.css(d.slice(0,p),o);var b=t.css(d[r],"position"),y=(r+c-f)%c,x=(f-r+c)%c;x>y&&"relative"==b?t.css(i.content,u,-(g*(c+r))):r==c-1&&0==f?t.css(i.content,u,g):t.css(i.content,u,-(g*r)),i.anim&&i.anim.stop(),i.anim=new n(i.content,h,s.duration,s.easing,function(){i.anim=0,e&&e()}).run()}function r(e,a){var i,r=this,o=r.fromIndex,l=r.config,u=r.length,f="scrollx"===l.scrollType,g=f?"left":"top",d=r.activeIndex,h=r.viewSize[f?0:1],v=-h*d,p=r.panels,m=r.config.steps,b={},y="backward"===a;i=y&&0===o&&d===u-1||!y&&o===u-1&&0===d,r.anim&&(r.anim.stop(),"relative"==p[o*m].style.position&&c.call(r,p,o,g,h,1)),i&&(v=s.call(r,p,d,g,h)),b[g]=v+"px",o>-1?r.anim=new n(r.content,b,l.duration,l.easing,function(){i&&c.call(r,p,d,g,h,1),r.anim=void 0,e&&e()}).run():(t.css(r.content,b),e&&e())}function s(e,n,a,i){var r,s=this,c=s.config,o=c.steps,l=s.length,u=n*o,f=(n+1)*o;return r=e.slice(u,f),t.css(r,"position","relative"),t.css(r,a,(n?-1:1)*i*l),n?i:-i*l}function c(e,n,a,i,r){var s,c=this,o=c.config,l=o.steps,u=c.length,f=n*l,g=(n+1)*l;s=e.slice(f,g),t.css(s,"position",""),t.css(s,a,""),r&&t.css(c.content,a,n?-i*(u-1):"")}var o={position:"",left:"",top:""};e.mix(a.Config,{circular:!1}),a.adjustPosition=s,a.resetPosition=c,a.addPlugin({name:"circular",priority:5,init:function(e){var t=e.config,n=t.effect;!t.circular||"scrollx"!==n&&"scrolly"!==n||(t.scrollType=n,t.effect=e._realStep?i:r)}})},{requires:["dom","anim","./base","./effect"]}),KISSY.add(function(e,t,n,a){function i(){this.stop&&this.stop()}function r(){this.start&&this.start()}a.addPlugin({name:"aria",init:function(e){if(e.config.aria){var t=e.container;n.on(t,"focusin",i,e),n.on(t,"focusout",r,e)}}});var s=["a","input","button","object"],c="oriTabIndex";return{setTabIndex:function(n,a){n.tabIndex=a,e.each(t.query("*",n),function(n){var i=n.nodeName.toLowerCase();e.inArray(i,s)&&(t.hasAttr(n,c)||t.attr(n,c,n.tabIndex),n.tabIndex=-1!=a?t.attr(n,c):a)})}}},{requires:["dom","event","./base"]}),KISSY.add("gallery/switchable/1.3/carousel/aria",function(e,t,n,a,i,r){function s(t){var n=this,a=n.config.steps,i=t.currentIndex,r=n.activeIndex,s=n.panels,c=s[i*a],o=n.triggers,l=o[i],u=t.originalEvent&&!(!t.originalEvent.target&&!t.originalEvent.srcElement);(u||-1==r)&&(e.each(o,function(e){I(e,-1)}),e.each(s,function(e){I(e,-1)}),l&&I(l,0),I(c,0),u&&c.focus())}function c(n){var a=null;return e.each(this.triggers,function(e){return e==n||t.contains(e,n)?(a=e,!1):void 0}),a}function o(e){var n=t.next(e),a=this.triggers;n||(n=a[0]),I(e,-1),n&&(I(n,0),n.focus())}function l(e){var n=t.prev(e),a=this.triggers;n||(n=a[a.length-1]),I(e,-1),n&&(I(n,0),n.focus())}function u(t){var n,a=t.keyCode,i=this,r=t.target;switch(a){case y:case b:n=c.call(i,r),n&&(o.call(i,n),t.halt());break;case m:case p:n=c.call(i,r),n&&(l.call(i,n),t.halt());break;case w:case x:n=c.call(i,r),n&&(i.switchTo(e.indexOf(n,i.triggers),void 0,T),t.halt())}}function f(n){var a=null;return e.each(this.panels,function(e){return e==n||t.contains(e,n)?(a=e,!1):void 0}),a}function g(e){var n=this,a=t.next(e),i=n.panels;a||(a=i[0]),I(e,-1),I(a,0),h.call(n,a,_)&&a.focus()}function d(e){var n=t.prev(e),a=this,i=a.panels;n||(n=i[i.length-1]),I(e,-1),I(n,0),h.call(a,n,k)&&n.focus()}function h(t,n){var a=this,i=e.indexOf(t,a.panels),r=a.config.steps,s=Math.floor(i/r);return s==a.activeIndex?1:0==i%r||i%r==r-1?(a.switchTo(s,n,T),0):1}function v(e){var t,n=this,a=e.keyCode,i=e.target;switch(a){case y:case b:t=f.call(n,i),t&&(g.call(n,t),e.halt());break;case m:case p:t=f.call(n,i),t&&(d.call(n,t),e.halt());break;case w:case x:t=f.call(n,i),t&&(n.fire("itemSelected",{item:t}),e.halt())}}var p=37,m=38,b=39,y=40,x=32,w=13,I=a.setTabIndex,T={originalEvent:{target:1}},_="forward",k="backward";e.mix(i.Config,{aria:!1}),r.addPlugin({name:"aria",init:function(t){if(t.config.aria){var a=t.triggers,i=t.panels,r=t.content,c=t.activeIndex;r.id||(r.id=e.guid("ks-switchbale-content")),r.setAttribute("role","listbox");var o=0;e.each(a,function(e){I(e,c==o?"0":"-1"),e.setAttribute("role","button"),e.setAttribute("aria-controls",r.id),o++}),o=0,e.each(i,function(e){I(e,"-1"),e.setAttribute("role","option"),o++}),t.on("switch",s,t);var l=t.nav;l&&n.on(l,"keydown",u,t),n.on(r,"keydown",v,t);var f=t.prevBtn,g=t.nextBtn;f&&(I(f,0),f.setAttribute("role","button"),n.on(f,"keydown",function(e){(e.keyCode==w||e.keyCode==x)&&(t.prev(T),e.preventDefault())})),g&&(I(g,0),g.setAttribute("role","button"),n.on(g,"keydown",function(e){(e.keyCode==w||e.keyCode==x)&&(t.next(T),e.preventDefault())}))}}},i)},{requires:["dom","event","../aria","./base","../base"]}),KISSY.add("gallery/switchable/1.3/autoplay",function(e,t,n,a,i){var r=200,s=e.Env.host,c=function(e){var n=t.scrollTop(),a=t.viewportHeight(),i=t.offset(e),r=t.height(e);return i.top>n&&n+a>i.top+r};return e.mix(a.Config,{pauseOnScroll:!1,autoplay:!1,interval:5,pauseOnHover:!0}),a.addPlugin({name:"autoplay",init:function(t){function a(){o=e.later(function(){t.paused||t.next()},u,!0)}var o,l=t.config,u=1e3*l.interval;l.autoplay&&(l.pauseOnScroll&&(t.__scrollDetect=e.buffer(function(){t[c(t.container)?"start":"stop"]()},r),n.on(s,"scroll",t.__scrollDetect)),a(),t.stop=function(){o&&(o.cancel(),o=i),t.paused=!0},t.start=function(){o&&(o.cancel(),o=i),t.paused=!1,a()},l.pauseOnHover&&(n.on(t.container,"mouseenter",t.stop,t),n.on(t.container,"mouseleave",t.start,t)))},destroy:function(e){e.__scrollDetect&&(n.remove(s,"scroll",e.__scrollDetect),e.__scrollDetect.stop())}}),a},{requires:["dom","event","./base"]}),KISSY.add("gallery/switchable/1.3/tabs/aria",function(e,t,n,a,i,r){function s(n){var a=this.triggers,i=null;return e.each(a,function(e){(e==n||t.contains(e,n))&&(i=e)}),i}function c(e){switch(e.keyCode){case u:case f:!e.ctrlKey||e.altKey||e.shiftKey||e.halt();break;case m:e.ctrlKey&&!e.altKey&&e.halt()}}function o(e){var t=e.target,n=this,a=e.ctrlKey&&!e.shiftKey&&!e.altKey;switch(e.keyCode){case d:case h:s.call(n,t)&&(n.prev(y(e)),e.halt());break;case v:case p:s.call(n,t)&&(n.next(y(e)),e.halt());break;case f:a&&(e.halt(),n.next(y(e)));break;case u:a&&(e.halt(),n.prev(y(e)));break;case m:e.ctrlKey&&!e.altKey&&(e.halt(),e.shiftKey?n.prev(y(e)):n.next(y(e)))}}function l(e){var t=e.originalEvent&&!(!e.originalEvent.target&&!e.originalEvent.srcElement),n=this,a=e.fromIndex,i=e.currentIndex;if(a!=i){var r=n.triggers[a],s=n.triggers[i],c=n.panels[a],o=n.panels[i];if(r&&b(r,"-1"),b(s,"0"),t)try{s.focus()}catch(l){}c&&c.setAttribute("aria-hidden","true"),o.setAttribute("aria-hidden","false")}}var u=33,f=34,g="added",d=37,h=38,v=39,p=40,m=9;e.mix(r.Config,{aria:!0}),a.addPlugin({name:"aria",init:function(a){function i(t){t.setAttribute("role","tab"),b(t,"-1"),t.id||(t.id=e.guid("ks-switchable"))}function r(e,t){e.setAttribute("role","tabpanel"),e.setAttribute("aria-hidden","true"),e.setAttribute("aria-labelledby",t.id)}if(a.config.aria){var s=a.triggers,u=a.activeIndex,f=a.panels,d=a.container;a.nav&&t.attr(a.nav,"role","tablist");var h=0;e.each(s,i),a.on(g,function(e){var t;i(t=e.trigger),r(e.panel,t)}),h=0,e.each(f,function(e){var t=s[h];r(e,t),h++}),u>-1&&(b(s[u],"0"),f[u].setAttribute("aria-hidden","false")),a.on("switch",l,a),n.on(d,"keydown",o,a),n.on(d,"keypress",c,a)}}},r);var b=i.setTabIndex,y=a.getDomEvent},{requires:["dom","event","../base","../aria","./base"]}),KISSY.add("gallery/switchable/1.3/accordion/aria",function(e,t,n,a,i,r){function s(n){var a=this.triggers,i=null;return e.each(a,function(e){(e==n||t.contains(e,n))&&(i=e)}),i}function c(n){var a=this.panels,i=null;return e.each(a,function(e){(e==n||t.contains(e,n))&&(i=e)}),i}function o(t){var n=this,a=n.triggers,i=n.panels;return a[e.indexOf(t,i)]}function l(e){var t=this,n=s.call(t,e);return n||(n=o.call(t,c.call(t,e))),n}function u(e){switch(e.keyCode){case b:case y:!e.ctrlKey||e.altKey||e.shiftKey||e.halt();break;case C:e.ctrlKey&&!e.altKey&&e.halt()}}function f(e){var t,n=e.target,a=this,i=a.triggers,r=!e.ctrlKey&&!e.shiftKey&&!e.altKey,c=e.ctrlKey&&!e.shiftKey&&!e.altKey;switch(e.keyCode){case P:case S:(t=s.call(a,n))&&r&&(p.call(a,t),e.halt());break;case I:case T:(t=s.call(a,n))&&(d.call(a,t),e.halt());break;case _:case k:(t=s.call(a,n))&&(v.call(a,t),e.halt());break;case y:c&&(e.halt(),t=l.call(a,n),v.call(a,t));break;case b:c&&(e.halt(),t=l.call(a,n),d.call(a,t));break;case w:r&&(t=l.call(a,n),h.call(a,0),e.halt());break;case x:r&&(t=l.call(a,n),h.call(a,i.length-1),e.halt());break;case C:e.ctrlKey&&!e.altKey&&(e.halt(),t=l.call(a,n),e.shiftKey?d.call(a,t):v.call(a,t))}}function g(n,a){var i=this,r=i.triggers,s=r[n];if(e.each(r,function(e){e!==s&&(K(e,"-1"),t.removeClass(e,"ks-switchable-select"),e.setAttribute("aria-selected","false"))}),a)try{s.focus()}catch(c){}K(s,"0"),t.addClass(s,"ks-switchable-select"),s.setAttribute("aria-selected","true")}function d(t){var n=this,a=n.triggers,i=e.indexOf(t,a),r=0==i?a.length-1:i-1;g.call(n,r,!0)}function h(e){g.call(this,e,!0)}function v(t){var n=this,a=n.triggers,i=e.indexOf(t,a),r=i==a.length-1?0:i+1;g.call(n,r,!0)}function p(t){var n=this;n.switchTo(e.indexOf(t,n.triggers))}function m(t){var n=t.originalEvent&&!(!t.originalEvent.target&&!t.originalEvent.srcElement),a=this,i=a.config.multiple,r=t.currentIndex,s=a.panels,c=a.triggers,o=c[r],l=s[r];i||(e.each(s,function(e){e!==l&&e.setAttribute("aria-hidden","true")}),e.each(c,function(e){e!==o&&e.setAttribute("aria-hidden","true")}));var u=l.getAttribute("aria-hidden");l.setAttribute("aria-hidden","false"==u?"true":"false"),o.setAttribute("aria-expanded","false"==u?"false":"true"),g.call(a,r,n)}var b=33,y=34,x=35,w=36,I=37,T=38,_=39,k=40,C=9,S=32,P=13;e.mix(i.Config,{aria:!0}),r.addPlugin({name:"aria",init:function(a){if(a.config.aria){var i=a.container,r=a.activeIndex;t.attr(i,"aria-multiselectable",a.config.multiple?"true":"false"),a.nav&&t.attr(a.nav,"role","tablist");var s=a.triggers,c=a.panels,o=0;e.each(c,function(t){t.id||(t.id=e.guid("ks-accordion-tab-panel"))}),e.each(s,function(t){t.id||(t.id=e.guid("ks-accordion-tab"))}),e.each(s,function(e){e.setAttribute("role","tab"),e.setAttribute("aria-expanded",r==o?"true":"false"),e.setAttribute("aria-selected",r==o?"true":"false"),e.setAttribute("aria-controls",c[o].id),K(e,r==o?"0":"-1"),o++}),o=0,e.each(c,function(e){var t=s[o];e.setAttribute("role","tabpanel"),e.setAttribute("aria-hidden",r==o?"false":"true"),e.setAttribute("aria-labelledby",t.id),o++}),a.on("switch",m,a),n.on(i,"keydown",f,a),n.on(i,"keypress",u,a)}}},i);var K=a.setTabIndex},{requires:["dom","event","../aria","./base","../base"]}),KISSY.add("gallery/switchable/1.3/touch",function(e,t,n,a,i){e.mix(a.Config,{mouseAsTouch:!1}),a.addPlugin({name:"touch",init:function(n){function r(){return"relative"==n.panels[n.activeIndex].style.position?(w.stopDrag(),void 0):(n.stop&&n.stop(),b=t.offset(p),y=c(m),void 0)}function s(e,t,n){return e>=t&&n>=e}function c(e){var n=t.offset(e);return n.bottom=n.top+m.offsetHeight,n.right=n.left+m.offsetWidth,n}function o(e){var i,r={};if("scrolly"==f?(v=n.viewSize[1],h=e.pageY-d,r.top=b.top+h,i=s(e.pageY,y.top,y.bottom)):(v=n.viewSize[0],h=e.pageX-g,r.left=b.left+h,i=s(e.pageX,y.left,y.right)),n.anim&&(n.anim.stop(),n.anim=void 0),i){if(u.circular){var c=n.activeIndex,o=n.length-1;c==o?a.adjustPosition.call(n,n.panels,0,x,v):0==c&&a.adjustPosition.call(n,n.panels,o,x,v)}t.offset(p,r)}else w.stopDrag()}function l(){var e=n.activeIndex,t=n.length-1;return!u.circular&&(0>h&&e==t||h>0&&0==e)?(a.Effects[f].call(n,void 0,void 0,!0),void 0):(0>h&&e==t||h>0&&0==e||(0==e||e==t)&&a.resetPosition.call(n,n.panels,0==e?t:0,x,v),n[0>h?"next":"prev"](),n.start&&n.start(),void 0)}if(!n._realStep){var u=n.config,f=u.scrollType||u.effect;if("scrolly"==f||"scrollx"==f){var g,d,h,v,p=n.content,m=n.container,b={},y={},x="left";if("scrolly"==f&&(x="top"),u.mouseAsTouch&&(i=e.require("dd/base")),i){var w=new i.Draggable({node:p,groups:!1});w.on("dragstart",function(){r(),g=w.get("startMousePos").left,d=w.get("startMousePos").top}),w.on("drag",o),w.on("dragend",l),n.__touchDD=w}}}},destroy:function(e){var t;(t=e.__touchDD)&&t.destroy()}})},{requires:["dom","event","./base",KISSY.Features.isTouchSupported()?"dd/base":""]}),KISSY.add("gallery/switchable/1.3/index",function(e,t,n,a,i,r){var s={Accordion:n,Carousel:a,Slide:i,Tabs:r};return e.mix(t,s),t},{requires:["./base","./accordion/base","./carousel/base","./slide/base","./tabs/base","./lazyload","./effect","./circular","./carousel/aria","./autoplay","./aria","./tabs/aria","./accordion/aria","./touch"]});